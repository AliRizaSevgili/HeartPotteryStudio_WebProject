<!-- Stepper/Progress Bar -->
<section aria-label="Checkout Progress" class="w-full">
  <div class="w-full max-w-2xl mx-auto flex justify-between items-center mt-40 mb-12">
    <div class="flex-1 flex flex-col items-center">
      <button id="step-cart-btn" type="button" class="focus:outline-none">
        <div id="step-cart" class="step-circle w-8 h-8 rounded-full bg-indigo-500 text-white font-bold">1</div>
      </button>
      <span class="mt-2 text-sm font-semibold text-indigo-700">Cart</span>
    </div>
    <div class="flex-1 border-t-2 border-indigo-300 mx-2"></div>
    <div class="flex-1 flex flex-col items-center">
      <button id="step-delivery-btn" type="button" class="focus:outline-none">
        <div id="step-delivery" class="step-circle w-8 h-8 rounded-full bg-gray-200 text-gray-700 font-bold">2</div>
      </button>
      <span class="mt-2 text-sm font-semibold text-gray-700">Info</span>
    </div>
    <div class="flex-1 border-t-2 border-indigo-300 mx-2"></div>
    <div class="flex-1 flex flex-col items-center">
      <button id="step-payment-btn" type="button" class="focus:outline-none">
        <div id="step-payment" class="step-circle w-8 h-8 rounded-full bg-gray-200 text-gray-700 font-bold">3</div>
      </button>
      <span class="mt-2 text-sm font-semibold text-gray-700">Payment</span>
    </div>
  </div>
</section>




<!-- Cart Section -->
<section>
  <div id="cart-section" class="container mx-auto mt-10">
    <div class="sm:flex shadow-md my-10">
      <div class="w-full sm:w-3/4 bg-white px-10 py-10">
        <div class="flex justify-between border-b pb-8">
          <h1 class="font-semibold text-2xl">Cart</h1>
          <h2 class="font-semibold text-2xl">
            {{#if cart.length}}
              {{cart.length}} Items
            {{else}}
              0 Items
            {{/if}}
          </h2>
        </div>
        {{#if selectedClass}}
        <!-- Seçilen slot ve class bilgileri -->
        <div class="md:flex items-stretch py-8 md:py-10 lg:py-8 border-t border-gray-50">
          <div class="md:w-4/12 2xl:w-1/4 w-full">
            <img src="{{selectedClass.image}}" alt="{{selectedClass.title}}" class="h-full object-center object-cover rounded-lg" />
          </div>
          <div class="md:pl-3 md:w-8/12 2xl:w-3/4 flex flex-col justify-center">
            <p class="text-base font-bold text-gray-800 mb-2">{{selectedClass.title}}</p>
            <p class="text-sm text-gray-600 mb-1"><strong>Day:</strong> {{selectedClass.slotDay}}</p>
            <p class="text-sm text-gray-600 mb-1"><strong>Date:</strong> {{selectedClass.slotDate}}</p>
            <p class="text-sm text-gray-600 mb-1"><strong>Time:</strong> {{selectedClass.slotTime}}</p>
            <div class="flex items-center justify-between pt-5">
              <div class="flex items-center">
                <p class="text-xs leading-3 underline text-gray-800 cursor-pointer">Add to favorites</p>
                <p class="text-xs leading-3 underline text-red-500 pl-5 cursor-pointer">Remove</p>
              </div>
              <p class="text-base font-black leading-none text-gray-800">{{selectedClass.price}}</p>
            </div>
          </div>
        </div>
        {{else}}
        <!-- Demo ürünler -->
        {{#if cart.length}}
          {{#each cart}}
            <div class="md:flex items-stretch py-8 md:py-10 lg:py-8 border-t border-gray-50">
              <div class="md:w-4/12 2xl:w-1/4 w-full">
                <img src="{{classImage}}" alt="{{classTitle}}" class="h-full object-center object-cover rounded-lg" />
              </div>
              <div class="md:pl-3 md:w-8/12 2xl:w-3/4 flex flex-col justify-center">
                <p class="text-base font-bold text-gray-800 mb-2">{{classTitle}}</p>
                <p class="text-sm text-gray-600 mb-1"><strong>Day:</strong> {{slotDay}}</p>
                <p class="text-sm text-gray-600 mb-1"><strong>Date:</strong> {{slotDate}}</p>
                <p class="text-sm text-gray-600 mb-1"><strong>Time:</strong> {{slotTime}}</p>
                <div class="flex items-center justify-between pt-5">
                  <p class="text-base font-black leading-none text-gray-800">{{classPrice}}</p>
                  <form method="POST" action="/remove-from-cart" class="ml-4">
                    <input type="hidden" name="classId" value="{{classId}}">
                    <input type="hidden" name="slotDay" value="{{slotDay}}">
                    <input type="hidden" name="slotDate" value="{{slotDate}}">
                    <input type="hidden" name="slotTime" value="{{slotTime}}">
                    <button type="submit" class="text-xs leading-3 underline text-red-500 cursor-pointer hover:text-red-700 transition">
                      Remove
                    </button>
                  </form>
                </div>
              </div>
            </div>
          {{/each}}
        {{else}}
          <p>Your cart is empty.</p>
        {{/if}}

        <a href="#" onclick="window.history.length > 1 ? history.back() : window.location.href='/learn'" class="flex font-semibold text-indigo-600 text-sm mt-10 transition-all duration-150 hover:text-indigo-800 hover:text-base">
          <svg class="fill-current mr-2 text-indigo-600 w-4" viewBox="0 0 448 512">
            <path d="M134.059 296H436c6.627 0 12-5.373 12-12v-56c0-6.627-5.373-12-12-12H134.059v-46.059c0-21.382-25.851-32.09-40.971-16.971L7.029 239.029c-9.373 9.373-9.373 24.569 0 33.941l86.059 86.059c15.119 15.119 40.971 4.411 40.971-16.971V296z"/>
          </svg>
          Continue Shopping
        </a>
        {{/if}}
      </div>
      <div id="summary" class="w-full sm:w-1/4 md:w-1/2 px-8 py-10">
        <h1 class="font-semibold text-2xl border-b pb-8">Order Summary</h1>
        <div class="mt-8 mb-5">
          <!-- Order Summary -->
          <ul class="divide-y divide-gray-200">
            {{#each cart}}
              <li class="flex justify-between py-2">
                <span class="text-sm text-gray-700">{{classTitle}} ({{slotDate}} {{slotTime}})</span>
                <span class="text-sm font-semibold text-gray-900">{{classPrice}}</span>
              </li>
            {{/each}}
          </ul>
        </div>
        <div class="flex justify-between mt-10 mb-5">
          <span class="font-semibold text-sm uppercase">
            {{#if cart.length}}
              Items {{cart.length}}
            {{else}}
              Items 0
            {{/if}}
          </span>
          <span class="font-semibold text-sm">
            {{#if cart.length}}
              ${{sum cart "classPrice"}}
            {{else}}
              $0
            {{/if}}
          </span>
        </div>
        <form method="POST" action="/apply-promo" class="mb-2">
          <label for="promo" class="font-semibold inline-block mb-3 text-sm uppercase">
            Promo Code
          </label>
          <input
            type="text"
            id="promo"
            name="promo"
            placeholder="Enter your code"
            class="p-2 text-sm w-full"
          />
          <button class="bg-red-500 hover:bg-red-600 px-5 py-2 text-sm text-white uppercase mt-2" type="submit">
            Apply
          </button>
        </form>
        {{#if promoMessage}}
          <div class="text-xs text-indigo-700 mb-2">{{promoMessage}}</div>
        {{/if}}
        <div class="border-t mt-8">
          <div class="space-y-1 mb-4 mt-4">
            <div class="flex justify-between text-sm text-gray-700">
              <span>Subtotal</span>
              <span>
                {{#if cart.length}}
                  ${{sum cart "classPrice"}}
                {{else}}
                  $0
                {{/if}}
              </span>
            </div>
            <div class="flex justify-between text-sm text-gray-700">
              <span>Savings</span>
              <span>
                {{#if promo}}
                  -${{discountAmount cart promo.discount}}
                {{else}}
                  $0
                {{/if}}
              </span>
            </div>
            <!-- Canada GST satırı kaldırıldı -->
            <div class="flex justify-between text-sm text-gray-700">
              <span>Tax (HST 13%)</span>
              <span>
                ${{taxAmount cart 0.13}}
              </span>
            </div>
          </div>
          <div class="flex font-semibold justify-between py-6 text-sm uppercase">
            <span>Total cost</span>
            <span>
              {{#if promo}}
                ${{discountedTotal cart promo.discount}}
              {{else}}
                ${{sum cart "classPrice"}}
              {{/if}}
            </span>
          </div>
          <button id="go-to-delivery" class="bg-indigo-500 font-semibold hover:bg-indigo-600 py-3 text-sm text-white uppercase w-full">
            Checkout
          </button>
        </div>
      </div>
    </div>
  </div>
</section>




<!-- Delivery Details Section (başlangıçta gizli) -->
<section id="delivery-section" class="bg-white py-8 antialiased dark:bg-gray-900 md:py-16 hidden">
  <form action="#" class="mx-auto max-w-screen-xl px-4 2xl:px-0">
    <div class="mt-6 sm:mt-8 lg:flex lg:items-start lg:gap-12 xl:gap-16">
      <div class="min-w-0 flex-1 space-y-8">
        <div class="space-y-4">
          <h2 class="text-xl font-semibold text-gray-900 dark:text-white">Participant Information</h2>
          <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
            <div>
              <label for="your_name" class="mb-2 block text-sm font-medium text-gray-900 dark:text-white">Your Name*</label>
              <input type="text" id="your_name" name="your_name" class="block w-full rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-[#b5651d] focus:ring-[#b5651d]" placeholder="Please enter your name" required />
            </div>
            <div>
              <label for="your_email" class="mb-2 block text-sm font-medium text-gray-900 dark:text-white">Email*</label>
              <input type="email" id="your_email" name="your_email" class="block w-full rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-[#b5651d] focus:ring-[#b5651d]" placeholder="email@email.com" required />
            </div>
            <div>
              <label for="phone-input" class="mb-2 block text-sm font-medium text-gray-900 dark:text-white">Phone Number*</label>
              <div class="flex items-center">
                <select id="country-code" name="countryCode" class="rounded-s-lg border border-gray-300 bg-gray-100 px-2 py-2.5 text-sm text-gray-900">
                  <option value="+1">🇨🇦 +1</option>      <!-- Canada -->
                  <option value="+1">🇺🇸 +1</option>      <!-- United States -->
                  <option value="+91">🇮🇳 +91</option>    <!-- India -->
                  <option value="+86">🇨🇳 +86</option>    <!-- China -->
                  <option value="+63">🇵🇭 +63</option>    <!-- Philippines -->
                  <option value="+92">🇵🇰 +92</option>    <!-- Pakistan -->
                  <option value="+98">🇮🇷 +98</option>    <!-- Iran -->
                  <option value="+33">🇫🇷 +33</option>    <!-- France -->
                  <option value="+39">🇮🇹 +39</option>    <!-- Italy -->
                  <option value="+49">🇩🇪 +49</option>    <!-- Germany -->
                  <option value="+82">🇰🇷 +82</option>    <!-- South Korea -->
                  <option value="+84">🇻🇳 +84</option>    <!-- Vietnam -->
                  <option value="+961">🇱🇧 +961</option>  <!-- Lebanon -->
                  <option value="+90">🇹🇷 +90</option>    <!-- Turkey -->
                  <option value="+44">🇬🇧 +44</option>    <!-- United Kingdom -->
                  <option value="+34">🇪🇸 +34</option>    <!-- Spain -->
                  <option value="+55">🇧🇷 +55</option>    <!-- Brazil -->
                  <option value="+27">🇿🇦 +27</option>    <!-- South Africa -->
                  <option value="+81">🇯🇵 +81</option>    <!-- Japan -->
                  <option value="+966">🇸🇦 +966</option>  <!-- Saudi Arabia -->
                  <option value="+971">🇦🇪 +971</option>  <!-- United Arab Emirates -->
                  <option value="+234">🇳🇬 +234</option>  <!-- Nigeria -->
                  <option value="+48">🇵🇱 +48</option>    <!-- Poland -->
                  <option value="+420">🇨🇿 +420</option>  <!-- Czech Republic -->
                  <option value="+421">🇸🇰 +421</option>  <!-- Slovakia -->
                  <option value="+36">🇭🇺 +36</option>    <!-- Hungary -->
                  <option value="+30">🇬🇷 +30</option>    <!-- Greece -->
                  <option value="+353">🇮🇪 +353</option>  <!-- Ireland -->
                  <option value="+43">🇦🇹 +43</option>    <!-- Austria -->
                  <option value="+31">🇳🇱 +31</option>    <!-- Netherlands -->
                  <option value="+32">🇧🇪 +32</option>    <!-- Belgium -->
                  <option value="+40">🇷🇴 +40</option>    <!-- Romania -->
                  <option value="+421">🇸🇰 +421</option>  <!-- Slovakia -->
                  <option value="+385">🇭🇷 +385</option>  <!-- Croatia -->
                  <option value="+381">🇷🇸 +381</option>  <!-- Serbia -->
                  <option value="+382">🇲🇪 +382</option>  <!-- Montenegro -->
                  <option value="+387">🇧🇦 +387</option>  <!-- Bosnia & Herzegovina -->
                  <option value="+359">🇧🇬 +359</option>  <!-- Bulgaria -->
                  <option value="+372">🇪🇪 +372</option>  <!-- Estonia -->
                  <option value="+371">🇱🇻 +371</option>  <!-- Latvia -->
                  <option value="+370">🇱🇹 +370</option>  <!-- Lithuania -->
                  <option value="+356">🇲🇹 +356</option>  <!-- Malta -->
                  <option value="+357">🇨🇾 +357</option>  <!-- Cyprus -->
                  <option value="+47">🇳🇴 +47</option>    <!-- Norway -->
                  <option value="+45">🇩🇰 +45</option>    <!-- Denmark -->
                  <option value="+358">🇫🇮 +358</option>  <!-- Finland -->
                  <option value="+46">🇸🇪 +46</option>    <!-- Sweden -->
                  <option value="+41">🇨🇭 +41</option>    <!-- Switzerland -->
                  <option value="+7">🇷🇺 +7</option>      <!-- Russia -->
                  <option value="+994">🇦🇿 +994</option>  <!-- Azerbaijan -->
                  <option value="+374">🇦🇲 +374</option>  <!-- Armenia -->
                  <option value="+995">🇬🇪 +995</option>  <!-- Georgia -->
                  <option value="+81">🇯🇵 +81</option>    <!-- Japan -->
                  <option value="+82">🇰🇷 +82</option>    <!-- South Korea -->
                  <option value="+86">🇨🇳 +86</option>    <!-- China -->
                  <option value="+66">🇹🇭 +66</option>    <!-- Thailand -->
                  <option value="+84">🇻🇳 +84</option>    <!-- Vietnam -->
                  <option value="+62">🇮🇩 +62</option>    <!-- Indonesia -->
                  <option value="+63">🇵🇭 +63</option>    <!-- Philippines -->
                  <option value="+60">🇲🇾 +60</option>    <!-- Malaysia -->
                  <option value="+65">🇸🇬 +65</option>    <!-- Singapore -->
                  <option value="+856">🇱🇦 +856</option>  <!-- Laos -->
                  <option value="+855">🇰🇭 +855</option>  <!-- Cambodia -->
                  <option value="+880">🇧🇩 +880</option>  <!-- Bangladesh -->
                  <option value="+977">🇳🇵 +977</option>  <!-- Nepal -->
                  <option value="+94">🇱🇰 +94</option>    <!-- Sri Lanka -->
                  <option value="+92">🇵🇰 +92</option>    <!-- Pakistan -->
                  <option value="+98">🇮🇷 +98</option>    <!-- Iran -->
                  <option value="+964">🇮🇶 +964</option>  <!-- Iraq -->
                  <option value="+962">🇯🇴 +962</option>  <!-- Jordan -->
                  <option value="+961">🇱🇧 +961</option>  <!-- Lebanon -->
                  <option value="+972">🇮🇱 +972</option>  <!-- Israel -->
                  <option value="+963">🇸🇾 +963</option>  <!-- Syria -->
                  <option value="+965">🇰🇼 +965</option>  <!-- Kuwait -->
                  <option value="+968">🇴🇲 +968</option>  <!-- Oman -->
                  <option value="+971">🇦🇪 +971</option>  <!-- United Arab Emirates -->
                  <option value="+966">🇸🇦 +966</option>  <!-- Saudi Arabia -->
                  <option value="+20">🇪🇬 +20</option>    <!-- Egypt -->
                  <!-- ...existing code... -->
                </select>
                <input type="text" id="phone-input" name="phone" class="z-20 block w-full rounded-e-lg border border-s-0 border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-[#b5651d] focus:ring-[#b5651d]" placeholder="555-555-5555" required />
              </div>
            </div>
            <div>
              <label for="select-city-input-3" class="mb-2 block text-sm font-medium text-gray-900 dark:text-white">City*</label>
              <input type="text" id="select-city-input-3" name="city" class="block w-full rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-[#b5651d] focus:ring-[#b5651d]" placeholder="Enter your city" required />
            </div>
            <div>
              <label for="address-input" class="mb-2 block text-sm font-medium text-gray-900 dark:text-white">Address*</label>
              <input type="text" id="address-input" name="address" class="block w-full rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-[#b5651d] focus:ring-[#b5651d]" placeholder="123 Main St, City, Country" required />
            </div>
            <div>
              <label for="postal_code" class="mb-2 block text-sm font-medium text-gray-900 dark:text-white">Postal Code*</label>
              <input type="text" id="postal_code" name="postal_code" class="block w-full rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-[#b5651d] focus:ring-[#b5651d]" placeholder="A1A 1A1" required />
            </div>
            <!-- Opsiyonel alanlar -->
            <div>
              <label for="company_name" class="mb-2 block text-sm font-medium text-gray-900 dark:text-white">Company Name (optional)</label>
              <input type="text" id="company_name" name="company_name" class="block w-full rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-[#b5651d] focus:ring-[#b5651d]" placeholder="" />
            </div>
          </div>
        </div>
        <div class="flex items-center justify-center gap-4 mt-8">
          <button type="button" id="back-to-cart"
            class="flex items-center gap-2 bg-white border border-gray-300 text-gray-700 px-4 py-2 rounded-lg shadow-sm hover:bg-gray-100 transition-all duration-150">
            <svg class="w-4 h-4 text-gray-500" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
    </svg>
            Back to Cart
          </button>
          <button type="submit" id="go-to-payment"
            class="flex items-center justify-center w-auto rounded-xl bg-[#b5651d] px-10 py-2.5 text-lg font-bold text-white shadow-lg hover:bg-[#a05a1b] transition-all duration-150 focus:outline-none focus:ring-2 focus:ring-[#f8dce2]">
            Pay Now
            <svg class="w-5 h-5 ml-2 text-white" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
    </svg>
          </button>
        </div>
      </div>
    </div>
  </form>
</section>




<!-- Payment Section (başlangıçta gizli) -->
<section id="payment-section" class="bg-gray-100 py-20 px-6 hidden">
  <div class="max-w-4xl mx-auto bg-white shadow-xl rounded-2xl overflow-hidden grid grid-cols-1 md:grid-cols-2">
    <!-- Checkout Form -->
    <div class="p-8">
      <h2 class="text-2xl font-bold text-gray-800 mb-4">Payment Details</h2>
      <form class="space-y-5">
        <div>
          <label class="block mb-1 text-sm text-gray-600">Name on Card</label>
          <input type="text" placeholder="John Doe" class="w-full border px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" />
        </div>
        <div>
          <label class="block mb-1 text-sm text-gray-600">Card Number</label>
          <input type="text" placeholder="1234 5678 9012 3456" class="w-full border px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" />
        </div>
        <div class="flex gap-4">
          <div class="w-1/2">
            <label class="block mb-1 text-sm text-gray-600">Expiry</label>
            <input type="text" placeholder="MM/YY" class="w-full border px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" />
          </div>
          <div class="w-1/2">
            <label class="block mb-1 text-sm text-gray-600">CVC</label>
            <input type="text" placeholder="123" class="w-full border px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" />
          </div>
        </div>
        <div class="flex gap-4 mt-8">
          <button type="button" id="back-to-delivery" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded">Back to Delivery</button>
          <button type="submit" class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white text-lg py-3 rounded-lg transition">Pay $49.99</button>
        </div>
      </form>
    </div>

    <!-- Payment Methods & Summary -->
    <div class="bg-gray-50 p-8 border-l border-gray-200">
      <h3 class="text-xl font-semibold text-gray-700 mb-6">Choose Payment Method</h3>

      <div class="space-y-4">
        <!-- Credit Card -->
        <div class="flex items-center p-4 bg-white rounded-lg shadow-sm border hover:shadow-md transition">
          <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/Visa.svg/512px-Visa.svg.png" class="h-6 mr-4" alt="Visa" />
          <p class="text-gray-700 font-medium">Credit / Debit Card</p>
        </div>
        
        <!-- PayPal -->
        <div class="flex items-center p-4 bg-white rounded-lg shadow-sm border hover:shadow-md transition">
          <img src="https://www.paypalobjects.com/webstatic/icon/pp258.png" class="h-6 mr-4" alt="PayPal" />
          <p class="text-gray-700 font-medium">PayPal</p>
        </div>

        <!-- Apple Pay -->
        <div class="flex items-center p-4 bg-white rounded-lg shadow-sm border hover:shadow-md transition">
          <img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg" class="h-6 mr-4" alt="Apple" />
          <p class="text-gray-700 font-medium">Apple Pay</p>
        </div>
      </div>

      <!-- Order Summary -->
      <div class="mt-10 border-t pt-6">
        <h4 class="text-gray-700 font-semibold mb-2">Order Summary</h4>
        <div class="flex justify-between text-gray-600">
          <span>Subscription Plan</span>
          <span>$49.99</span>
        </div>
        <div class="flex justify-between text-gray-600 mt-1">
          <span>Tax</span>
          <span>$0.00</span>
        </div>
        <div class="flex justify-between text-lg font-bold text-gray-800 mt-4">
          <span>Total</span>
          <span>$49.99</span>
        </div>
      </div>
    </div>
  </div>
</section>

<script src="/js/checkout_steps.js"></script>